{"variants":[{"traits":[{"interfaceLanguage":"swift"}],"paths":["\/documentation\/eudiwalletkit\/issuedocuments"]}],"kind":"article","abstract":[{"text":"The library provides the functionality to issue documents using OpenID4VCI.","type":"text"}],"hierarchy":{"paths":[["doc:\/\/EudiWalletKit\/documentation\/EudiWalletKit"]]},"seeAlsoSections":[{"generated":true,"anchor":"Essentials","identifiers":["doc:\/\/EudiWalletKit\/documentation\/EudiWalletKit\/GetStarted","doc:\/\/EudiWalletKit\/documentation\/EudiWalletKit\/ManageDocuments","doc:\/\/EudiWalletKit\/documentation\/EudiWalletKit\/SecureAreas","doc:\/\/EudiWalletKit\/documentation\/EudiWalletKit\/PresentationService","doc:\/\/EudiWalletKit\/documentation\/EudiWalletKit\/WalletUI"],"title":"Essentials"}],"sections":[],"identifier":{"interfaceLanguage":"swift","url":"doc:\/\/EudiWalletKit\/documentation\/EudiWalletKit\/IssueDocuments"},"schemaVersion":{"patch":0,"major":0,"minor":3},"primaryContentSections":[{"kind":"content","content":[{"anchor":"Overview","text":"Overview","type":"heading","level":3},{"inlineContent":[{"type":"text","text":"To issue a document"},{"type":"text","text":" "},{"type":"text","text":"using this functionality, EudiWallet must be property initialized."},{"type":"text","text":" "},{"text":"If ","type":"text"},{"type":"reference","identifier":"doc:\/\/EudiWalletKit\/documentation\/EudiWalletKit\/EudiWallet\/userAuthenticationRequired","isActive":true},{"type":"text","text":" is true, user authentication is required. The authentication prompt message has localisation key “issue_document”."},{"text":" ","type":"text"},{"text":"After issuing a document, the document data and corresponding private key are stored in the wallet storage.","type":"text"}],"type":"paragraph"},{"type":"heading","text":"Issue document by docType","level":3,"anchor":"Issue-document-by-docType"},{"type":"paragraph","inlineContent":[{"type":"text","text":"When the document docType to be issued use the "},{"identifier":"doc:\/\/EudiWalletKit\/documentation\/EudiWalletKit\/EudiWallet\/issueDocument(docType:format:keyOptions:promptMessage:)","type":"reference","isActive":true},{"type":"text","text":" method."}]},{"type":"paragraph","inlineContent":[{"type":"strong","inlineContent":[{"type":"text","text":"Important Notes"}]},{"type":"text","text":":"}]},{"items":[{"content":[{"inlineContent":[{"text":"Currently, only mso_mdoc format is supported","type":"text"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"For the ‘SecureEnclave’ secure area, only ES256 algorithm is supported for signing OpenId4CVI proof of possession of the"},{"type":"text","text":" "},{"text":"public\/private key pair.","type":"text"}]}]}],"type":"unorderedList"},{"type":"paragraph","inlineContent":[{"text":"The following example shows how to issue an EUDI Personal ID document using OpenID4VCI:","type":"text"}]},{"code":["wallet.openID4VciIssuerUrl = \"https:\/\/issuer.eudiw.dev\" ","wallet.openID4VciClientId = \"wallet-dev\"","wallet.openID4VciRedirectUri = \"eudi-openid4ci:\/\/authorize\/\" ","do {","\tlet doc = try await userWallet.: EuPidModel.euPidDocType, format: .cbor)","\t\/\/ document has been added to wallet storage, you can display it","}","catch {","\t\/\/ display error","}"],"type":"codeListing","syntax":"swift"},{"text":"Resolving Credential offer","type":"heading","anchor":"Resolving-Credential-offer","level":3},{"type":"paragraph","inlineContent":[{"text":"The library provides the ","type":"text"},{"isActive":true,"type":"reference","identifier":"doc:\/\/EudiWalletKit\/documentation\/EudiWalletKit\/EudiWallet\/resolveOfferUrlDocTypes(uriOffer:format:)"},{"text":" method that resolves the credential offer URI.","type":"text"},{"text":" ","type":"text"},{"type":"text","text":"The method returns the resolved "},{"type":"reference","identifier":"doc:\/\/EudiWalletKit\/documentation\/EudiWalletKit\/OfferedIssuanceModel","isActive":true},{"type":"text","text":" object that contains the offer’s data (offered document types, issuer name and transaction code specification for pre-authorized flow). The offer’s data can be displayed to the"},{"text":" ","type":"text"},{"text":"user.","type":"text"}]},{"type":"paragraph","inlineContent":[{"text":"The following example shows how to resolve a credential offer:","type":"text"}]},{"code":[" func resolveOfferUrlDocTypes(uriOffer: String) async throws -> OfferedIssuanceModel {","\t\treturn try await wallet.resolveOfferUrlDocTypes(uriOffer: uriOffer)","\t}"],"syntax":"swift","type":"codeListing"},{"inlineContent":[{"text":"After user acceptance of the offer, the selected documents can be issued using the ","type":"text"},{"isActive":true,"type":"reference","identifier":"doc:\/\/EudiWalletKit\/documentation\/EudiWalletKit\/EudiWallet\/issueDocumentsByOfferUrl(offerUri:docTypes:docTypeKeyOptions:txCodeValue:format:promptMessage:claimSet:)"},{"text":" method.","type":"text"},{"text":" ","type":"text"},{"text":"The ","type":"text"},{"code":"txCodeValue","type":"codeVoice"},{"text":" parameter is not used in the case of the authorization code flow.","type":"text"}],"type":"paragraph"},{"inlineContent":[{"type":"text","text":"The following example shows how to issue documents by offer URL:"}],"type":"paragraph"},{"type":"codeListing","code":[" let documents = try await walletController.issueDocumentsByOfferUrl(offerUri: uri,  docTypes: docOffers, format: .cbor, txCodeValue: txCodeValue )"],"syntax":"swift"},{"level":3,"text":"Authorization code flow","anchor":"Authorization-code-flow","type":"heading"},{"type":"paragraph","inlineContent":[{"text":"For the authorization code flow to work, the redirect URI must be specified specified by setting the the ","type":"text"},{"type":"reference","identifier":"doc:\/\/EudiWalletKit\/documentation\/EudiWalletKit\/EudiWallet\/openID4VciConfig","isActive":true},{"type":"text","text":" property."},{"text":" ","type":"text"},{"type":"text","text":"The user is redirected in an authorization web view to the issuer’s authorization endpoint. After the user authenticates and authorizes the request, the issuer redirects the user back to the application with an authorization code. The library exchanges the authorization code for an access token and issues the document."}]},{"type":"heading","text":"Pre-Authorization code flow","level":3,"anchor":"Pre-Authorization-code-flow"},{"type":"paragraph","inlineContent":[{"text":"When Issuer supports the pre-authorization code flow, the resolved offer will also contain the corresponding","type":"text"},{"type":"text","text":" "},{"type":"text","text":"information. Specifically, the "},{"code":"txCodeSpec","type":"codeVoice"},{"type":"text","text":" field in the "},{"identifier":"doc:\/\/EudiWalletKit\/documentation\/EudiWalletKit\/OfferedIssuanceModel","type":"reference","isActive":true},{"text":" object will contain:","type":"text"}]},{"items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"The input mode, whether it is NUMERIC or TEXT"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"The expected length of the input"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"The description of the input","type":"text"}]}]}],"type":"unorderedList"},{"type":"paragraph","inlineContent":[{"type":"text","text":"From the user’s perspective, the application must provide a way to input the transaction code."}]},{"type":"paragraph","inlineContent":[{"text":"After user acceptance of the offer, the selected documents can be issued using the ","type":"text"},{"type":"codeVoice","code":"EudiWallet\/issueDocumentsByOfferUrl(offerUri:docTypes:txCodeValue:format:promptMessage:useSecureEnclave:claimSet:)"},{"type":"text","text":" method."},{"type":"text","text":" "},{"type":"text","text":"When the transaction code is provided, the issuance process can be resumed by calling the above-mentioned method and passing the transaction code in the "},{"type":"codeVoice","code":"txCodeValue"},{"text":" parameter.","type":"text"}]},{"text":"Dynamic issuance","anchor":"Dynamic-issuance","type":"heading","level":3},{"type":"paragraph","inlineContent":[{"type":"text","text":"Wallet kit supports the Dynamic "},{"isActive":true,"type":"reference","identifier":"https:\/\/github.com\/eu-digital-identity-wallet\/eudi-wallet-product-roadmap\/issues\/82"}]},{"type":"paragraph","inlineContent":[{"text":"After calling ","type":"text"},{"isActive":true,"type":"reference","identifier":"doc:\/\/EudiWalletKit\/documentation\/EudiWalletKit\/EudiWallet\/issueDocument(docType:format:keyOptions:promptMessage:)"},{"type":"text","text":" or "},{"type":"reference","identifier":"doc:\/\/EudiWalletKit\/documentation\/EudiWalletKit\/EudiWallet\/issueDocumentsByOfferUrl(offerUri:docTypes:docTypeKeyOptions:txCodeValue:format:promptMessage:claimSet:)","isActive":true},{"type":"text","text":" the wallet application need to check if the doc is pending and has a "},{"type":"codeVoice","code":"authorizePresentationUrl"},{"text":" property. If the property is present, the application should perform the OpenID4VP presentation using the presentation URL. On success, the ","type":"text"},{"type":"codeVoice","code":"EudiWallet\/resumePendingIssuance(pendingDoc:webUrl:)"},{"type":"text","text":" method should be called with the authorization URL provided by the server."}]},{"code":["if let urlString = newDocs.last?.authorizePresentationUrl { ","\t\/\/ perform openid4vp presentation using the urlString ","\t\/\/ on success call resumePendingIssuance using the authorization url  "],"syntax":"swift","type":"codeListing"}]}],"metadata":{"role":"article","title":"Issue documents","modules":[{"name":"EudiWalletKit"}],"roleHeading":"Article"},"references":{"doc://EudiWalletKit/documentation/EudiWalletKit":{"kind":"symbol","abstract":[{"type":"text","text":"EUDI Wallet Kit library for iOS"}],"url":"\/documentation\/eudiwalletkit","identifier":"doc:\/\/EudiWalletKit\/documentation\/EudiWalletKit","role":"collection","title":"EudiWalletKit","type":"topic"},"doc://EudiWalletKit/documentation/EudiWalletKit/EudiWallet/resolveOfferUrlDocTypes(uriOffer:format:)":{"fragments":[{"kind":"keyword","text":"func"},{"text":" ","kind":"text"},{"text":"resolveOfferUrlDocTypes","kind":"identifier"},{"kind":"text","text":"("},{"kind":"externalParam","text":"uriOffer"},{"text":": ","kind":"text"},{"text":"String","kind":"typeIdentifier","preciseIdentifier":"s:SS"},{"kind":"text","text":", "},{"text":"format","kind":"externalParam"},{"text":": ","kind":"text"},{"kind":"typeIdentifier","preciseIdentifier":"s:13EudiWalletKit10DataFormatO","text":"DataFormat"},{"kind":"text","text":") "},{"kind":"keyword","text":"async"},{"text":" ","kind":"text"},{"text":"throws","kind":"keyword"},{"kind":"text","text":" -> "},{"text":"OfferedIssuanceModel","kind":"typeIdentifier","preciseIdentifier":"s:13EudiWalletKit20OfferedIssuanceModelV"}],"abstract":[{"text":"Resolve OpenID4VCI offer URL document types. Resolved offer metadata are cached","type":"text"}],"type":"topic","kind":"symbol","role":"symbol","title":"resolveOfferUrlDocTypes(uriOffer:format:)","url":"\/documentation\/eudiwalletkit\/eudiwallet\/resolveofferurldoctypes(urioffer:format:)","identifier":"doc:\/\/EudiWalletKit\/documentation\/EudiWalletKit\/EudiWallet\/resolveOfferUrlDocTypes(uriOffer:format:)"},"doc://EudiWalletKit/documentation/EudiWalletKit/EudiWallet/issueDocument(docType:format:keyOptions:promptMessage:)":{"title":"issueDocument(docType:format:keyOptions:promptMessage:)","role":"symbol","abstract":[{"type":"text","text":"Issue a document with the given docType using OpenId4Vci protocol"}],"url":"\/documentation\/eudiwalletkit\/eudiwallet\/issuedocument(doctype:format:keyoptions:promptmessage:)","kind":"symbol","type":"topic","fragments":[{"kind":"keyword","text":"func"},{"text":" ","kind":"text"},{"text":"issueDocument","kind":"identifier"},{"text":"(","kind":"text"},{"text":"docType","kind":"externalParam"},{"text":": ","kind":"text"},{"preciseIdentifier":"s:SS","text":"String","kind":"typeIdentifier"},{"text":", ","kind":"text"},{"text":"format","kind":"externalParam"},{"kind":"text","text":": "},{"kind":"typeIdentifier","text":"DataFormat","preciseIdentifier":"s:13EudiWalletKit10DataFormatO"},{"kind":"text","text":", "},{"kind":"externalParam","text":"keyOptions"},{"kind":"text","text":": "},{"kind":"typeIdentifier","preciseIdentifier":"s:18MdocDataModel1801310KeyOptionsV","text":"KeyOptions"},{"text":"?, ","kind":"text"},{"text":"promptMessage","kind":"externalParam"},{"kind":"text","text":": "},{"preciseIdentifier":"s:SS","kind":"typeIdentifier","text":"String"},{"text":"?) ","kind":"text"},{"text":"async","kind":"keyword"},{"kind":"text","text":" "},{"kind":"keyword","text":"throws"},{"text":" -> ","kind":"text"},{"kind":"typeIdentifier","preciseIdentifier":"s:13WalletStorage8DocumentV","text":"Document"}],"identifier":"doc:\/\/EudiWalletKit\/documentation\/EudiWalletKit\/EudiWallet\/issueDocument(docType:format:keyOptions:promptMessage:)"},"https://eu-digital-identity-wallet.github.io/eudi-lib-ios-iso18013-data-model/documentation/mdocdatamodel18013/securekeystorage":{"titleInlineContent":[{"type":"text","text":"SecureKeyStorage"}],"title":"SecureKeyStorage","type":"link","identifier":"https:\/\/eu-digital-identity-wallet.github.io\/eudi-lib-ios-iso18013-data-model\/documentation\/mdocdatamodel18013\/securekeystorage","url":"https:\/\/eu-digital-identity-wallet.github.io\/eudi-lib-ios-iso18013-data-model\/documentation\/mdocdatamodel18013\/securekeystorage"},"doc://EudiWalletKit/documentation/EudiWalletKit/EudiWallet/issueDocumentsByOfferUrl(offerUri:docTypes:docTypeKeyOptions:txCodeValue:format:promptMessage:claimSet:)":{"type":"topic","url":"\/documentation\/eudiwalletkit\/eudiwallet\/issuedocumentsbyofferurl(offeruri:doctypes:doctypekeyoptions:txcodevalue:format:promptmessage:claimset:)","identifier":"doc:\/\/EudiWalletKit\/documentation\/EudiWalletKit\/EudiWallet\/issueDocumentsByOfferUrl(offerUri:docTypes:docTypeKeyOptions:txCodeValue:format:promptMessage:claimSet:)","abstract":[{"type":"text","text":"Issue documents by offer URI."}],"fragments":[{"text":"func","kind":"keyword"},{"kind":"text","text":" "},{"text":"issueDocumentsByOfferUrl","kind":"identifier"},{"kind":"text","text":"("},{"text":"offerUri","kind":"externalParam"},{"text":": ","kind":"text"},{"preciseIdentifier":"s:SS","kind":"typeIdentifier","text":"String"},{"kind":"text","text":", "},{"text":"docTypes","kind":"externalParam"},{"text":": [","kind":"text"},{"preciseIdentifier":"s:13EudiWalletKit15OfferedDocModelV","text":"OfferedDocModel","kind":"typeIdentifier"},{"text":"], ","kind":"text"},{"kind":"externalParam","text":"docTypeKeyOptions"},{"kind":"text","text":": ["},{"text":"String","kind":"typeIdentifier","preciseIdentifier":"s:SS"},{"text":" : ","kind":"text"},{"kind":"typeIdentifier","preciseIdentifier":"s:18MdocDataModel1801310KeyOptionsV","text":"KeyOptions"},{"text":"]?, ","kind":"text"},{"kind":"externalParam","text":"txCodeValue"},{"text":": ","kind":"text"},{"text":"String","kind":"typeIdentifier","preciseIdentifier":"s:SS"},{"kind":"text","text":"?, "},{"kind":"externalParam","text":"format"},{"kind":"text","text":": "},{"preciseIdentifier":"s:13EudiWalletKit10DataFormatO","kind":"typeIdentifier","text":"DataFormat"},{"text":", ","kind":"text"},{"kind":"externalParam","text":"promptMessage"},{"text":": ","kind":"text"},{"kind":"typeIdentifier","preciseIdentifier":"s:SS","text":"String"},{"text":"?, ","kind":"text"},{"kind":"externalParam","text":"claimSet"},{"kind":"text","text":": "},{"kind":"typeIdentifier","preciseIdentifier":"s:10OpenID4VCI8ClaimSetO","text":"ClaimSet"},{"text":"?) ","kind":"text"},{"text":"async","kind":"keyword"},{"text":" ","kind":"text"},{"text":"throws","kind":"keyword"},{"kind":"text","text":" -> ["},{"preciseIdentifier":"s:13WalletStorage8DocumentV","text":"Document","kind":"typeIdentifier"},{"kind":"text","text":"]"}],"title":"issueDocumentsByOfferUrl(offerUri:docTypes:docTypeKeyOptions:txCodeValue:format:promptMessage:claimSet:)","role":"symbol","kind":"symbol"},"https://github.com/eu-digital-identity-wallet/eudi-wallet-product-roadmap/issues/82":{"titleInlineContent":[{"text":"PID based issuance","type":"text"}],"title":"PID based issuance","type":"link","identifier":"https:\/\/github.com\/eu-digital-identity-wallet\/eudi-wallet-product-roadmap\/issues\/82","url":"https:\/\/github.com\/eu-digital-identity-wallet\/eudi-wallet-product-roadmap\/issues\/82"},"doc://EudiWalletKit/documentation/EudiWalletKit/OfferedIssuanceModel":{"navigatorTitle":[{"text":"OfferedIssuanceModel","kind":"identifier"}],"fragments":[{"kind":"keyword","text":"struct"},{"kind":"text","text":" "},{"text":"OfferedIssuanceModel","kind":"identifier"}],"abstract":[{"text":"Offered issue model contains information gathered by resolving an issue offer URL.","type":"text"}],"type":"topic","kind":"symbol","role":"symbol","title":"OfferedIssuanceModel","url":"\/documentation\/eudiwalletkit\/offeredissuancemodel","identifier":"doc:\/\/EudiWalletKit\/documentation\/EudiWalletKit\/OfferedIssuanceModel"},"doc://EudiWalletKit/documentation/EudiWalletKit/SecureAreas":{"title":"Custom key management","type":"topic","role":"article","kind":"article","url":"\/documentation\/eudiwalletkit\/secureareas","abstract":[{"text":"Eudi Wallet Kit supports custom key management through the implementation of ","type":"text"},{"type":"reference","isActive":true,"identifier":"https:\/\/eu-digital-identity-wallet.github.io\/eudi-lib-ios-iso18013-data-model\/documentation\/mdocdatamodel18013\/securearea"},{"type":"text","text":" and "},{"isActive":true,"type":"reference","identifier":"https:\/\/eu-digital-identity-wallet.github.io\/eudi-lib-ios-iso18013-data-model\/documentation\/mdocdatamodel18013\/securekeystorage"},{"type":"text","text":" protocols. This document details the process of integrating custom key management with the library."}],"identifier":"doc:\/\/EudiWalletKit\/documentation\/EudiWalletKit\/SecureAreas"},"doc://EudiWalletKit/documentation/EudiWalletKit/PresentationService":{"url":"\/documentation\/eudiwalletkit\/presentationservice","identifier":"doc:\/\/EudiWalletKit\/documentation\/EudiWalletKit\/PresentationService","title":"Presentation Service","role":"article","type":"topic","abstract":[{"type":"text","text":"The library supports document presentation via BLE or online verifier"}],"kind":"article"},"doc://EudiWalletKit/documentation/EudiWalletKit/GetStarted":{"title":"Get started","identifier":"doc:\/\/EudiWalletKit\/documentation\/EudiWalletKit\/GetStarted","role":"article","type":"topic","abstract":[{"text":"How to install and initialize EUDI Wallet Kit in your project","type":"text"}],"kind":"article","url":"\/documentation\/eudiwalletkit\/getstarted"},"https://eu-digital-identity-wallet.github.io/eudi-lib-ios-iso18013-data-model/documentation/mdocdatamodel18013/securearea":{"titleInlineContent":[{"type":"text","text":"SecureArea"}],"title":"SecureArea","type":"link","identifier":"https:\/\/eu-digital-identity-wallet.github.io\/eudi-lib-ios-iso18013-data-model\/documentation\/mdocdatamodel18013\/securearea","url":"https:\/\/eu-digital-identity-wallet.github.io\/eudi-lib-ios-iso18013-data-model\/documentation\/mdocdatamodel18013\/securearea"},"doc://EudiWalletKit/documentation/EudiWalletKit/WalletUI":{"identifier":"doc:\/\/EudiWalletKit\/documentation\/EudiWalletKit\/WalletUI","role":"sampleCode","url":"\/documentation\/eudiwalletkit\/walletui","title":"EUDI iOS Wallet reference implementation","abstract":[],"kind":"article","type":"topic"},"doc://EudiWalletKit/documentation/EudiWalletKit/ManageDocuments":{"identifier":"doc:\/\/EudiWalletKit\/documentation\/EudiWalletKit\/ManageDocuments","abstract":[{"text":"The EudiWallet class provides a set of methods to work with documents.","type":"text"}],"url":"\/documentation\/eudiwalletkit\/managedocuments","kind":"article","type":"topic","role":"article","title":"Manage documents"},"doc://EudiWalletKit/documentation/EudiWalletKit/EudiWallet/openID4VciConfig":{"title":"openID4VciConfig","url":"\/documentation\/eudiwalletkit\/eudiwallet\/openid4vciconfig","role":"symbol","identifier":"doc:\/\/EudiWalletKit\/documentation\/EudiWalletKit\/EudiWallet\/openID4VciConfig","abstract":[{"text":"OpenID4VCI issuer parameters","type":"text"}],"fragments":[{"text":"var","kind":"keyword"},{"text":" ","kind":"text"},{"text":"openID4VciConfig","kind":"identifier"},{"text":": ","kind":"text"},{"text":"OpenId4VCIConfig","kind":"typeIdentifier","preciseIdentifier":"s:10OpenID4VCI0A12Id4VCIConfigV"},{"text":"?","kind":"text"}],"type":"topic","kind":"symbol"},"doc://EudiWalletKit/documentation/EudiWalletKit/EudiWallet/userAuthenticationRequired":{"title":"userAuthenticationRequired","kind":"symbol","type":"topic","identifier":"doc:\/\/EudiWalletKit\/documentation\/EudiWalletKit\/EudiWallet\/userAuthenticationRequired","url":"\/documentation\/eudiwalletkit\/eudiwallet\/userauthenticationrequired","fragments":[{"text":"var","kind":"keyword"},{"text":" ","kind":"text"},{"text":"userAuthenticationRequired","kind":"identifier"},{"text":": ","kind":"text"},{"text":"Bool","kind":"typeIdentifier","preciseIdentifier":"s:Sb"}],"abstract":[{"text":"Whether user authentication via biometrics or passcode is required before sending user data","type":"text"}],"role":"symbol"}}}